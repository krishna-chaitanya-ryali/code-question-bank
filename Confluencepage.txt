SELECT
    reportees_name        AS user_name,
    reportees_id          AS user_id,
    system_name           AS system,
    location_name         AS location,
    access_level          AS user_role,
    access_status         AS "Maintain / Revoke",
    actioned_by,
    updt_dt               AS actioned_date
FROM (
    SELECT
        rr.*,
        ROW_NUMBER() OVER (
            PARTITION BY
                rr.reportees_id,
                rr.location_name,
                rr.recert_year
            ORDER BY
                rr.updt_dt DESC
        ) rn
    FROM recert_response rr
    WHERE rr.recert_year = :year
)
WHERE rn = 1
ORDER BY user_name, location;