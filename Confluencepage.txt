WITH MISSING_METRICS AS (
    SELECT METRIC_DETAIL_ID
    FROM RAPUSER.RAP_METRICS_DETAILS
    WHERE METRIC_FLAG = 'Insert'
    MINUS
    SELECT MA.METRIC_DETAIL_ID
    FROM RAPUSER.METRIC_ACCESS MA
    WHERE MA.USER_ID = 851
)
SELECT
    851 AS USER_ID,
    (
        SELECT USER_ROLE_ID
        FROM MAP_RAP_USER_ROLE
        WHERE USER_ID = 851
          AND IS_ACTIVE = 1
          AND ROWNUM = 1
    ) AS USER_ROLE_ID,
    MM.METRIC_DETAIL_ID
FROM MISSING_METRICS MM;
