if updates:
    manager_ids = list(
        {u["lm_id"] for u in updates if u["lm_id"] and u["lm_id"] != "NO_LM"}
    )

    manager_mail_map = fetch_manager_mails(conn, manager_ids)

    for u in updates:
        if u["lm_id"] != "NO_LM":
            u["lm_mail"] = manager_mail_map.get(u["lm_id"])

    rows_updated += Db_Con.bulk_update_data(
        QueryString["UPDATE_USER_TAB_LM"]["QString"],
        updates
    )
