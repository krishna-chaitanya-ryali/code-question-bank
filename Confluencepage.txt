SELECT
    851 AS USER_ID,
    MRUR.USER_ROLE_ID,
    RMD.METRIC_DETAIL_ID,
    1 AS IS_ACTIVE,
    43461262 AS CREAT_BY,
    SYSDATE AS CREAT_DT,
    43461262 AS UPDT_BY,
    SYSDATE AS UPDT_DT
FROM (
    SELECT RMD.METRIC_DETAIL_ID
    FROM RAPUSER.RAP_METRICS_DETAILS RMD
    WHERE RMD.METRIC_FLAG = 'Insert'
    AND NOT EXISTS (
        SELECT 1
        FROM RAPUSER.METRIC_ACCESS MA
        WHERE MA.USER_ID = 851
          AND MA.METRIC_DETAIL_ID = RMD.METRIC_DETAIL_ID
    )
) RMD
JOIN MAP_RAP_USER_ROLE MRUR
  ON MRUR.USER_ID = 851
 AND MRUR.IS_ACTIVE = 1;
