SELECT 
    UT.USER_NAME,
    UT.EMP_ID,
    UR.ROLE_NAME,
    RRT.RISK_TYPE,
    RRT.RISK_HEADER,
    CASE 
        WHEN RMAP.METRICS_DISPLAY IS NULL 
        THEN RMD.METRICS_DISPLAY 
        ELSE RMAP.METRICS_DISPLAY 
    END AS METRICS_DISPLAY,
    RMA.ACCESS_RATIONALE
FROM USER_TAB UT
JOIN MAP_RAP_USER_ROLE MRUR 
    ON UT.USER_ID = MRUR.USER_ID
JOIN RAP_USER_ROLE UR 
    ON MRUR.ROLE_ID = UR.ROLE_ID
JOIN RAP_METRIC_ACCESS RMA 
    ON MRUR.USER_ID = RMA.USER_ID
JOIN RAP_METRICS_DETAILS RMD 
    ON RMA.METRIC_DETAIL_ID = RMD.METRIC_DETAIL_ID
JOIN RAP_RISK_TYPE RRT 
    ON RMD.RISK_TYPE_ID = RRT.RISK_TYPE_ID
JOIN RAP_RMM_GROUP RRG 
    ON RRG.RMM_ID = RMD.RMM_ID
JOIN RAP_METRICS_PACK_MAPPING RMAP 
    ON RMD.METRICS_MAPPING_ID = RMAP.METRICS_MAPPING_ID
JOIN MEET_INSTC MI 
    ON RMD.RMM_ID = MI.RMM_ID
WHERE MI.MEET_STAT_ID IN (2, 1)   -- keeping same meet status filter
ORDER BY UT.USER_NAME;
