SELECT m.MASTER_METRIC_ID,
       m.MASTER_METRIC_NAME AS MASTER_NAME,
       p.METRICS_DISP       AS EXPECTED_NAME,
       d.RAP_METRICS_MAPPING_ID
FROM RAP_MASTER_METRIC_DETAILS m
JOIN RAP_METRICS_DETAILS d
  ON d.MASTER_METRIC_ID = m.MASTER_METRIC_ID
JOIN RAP_METRICS_PACK_MAPPING p
  ON d.RAP_METRICS_MAPPING_ID = p.RAP_METRICS_MAPPING_ID
WHERE d.RAP_METRICS_MAPPING_ID = 25
  AND m.MASTER_METRIC_NAME <> p.METRICS_DISP;


UPDATE RAP_MASTER_METRIC_DETAILS m
SET m.MASTER_METRIC_NAME = (
        SELECT p.METRICS_DISP
        FROM RAP_METRICS_DETAILS d
        JOIN RAP_METRICS_PACK_MAPPING p
          ON d.RAP_METRICS_MAPPING_ID = p.RAP_METRICS_MAPPING_ID
        WHERE d.MASTER_METRIC_ID = m.MASTER_METRIC_ID
          AND d.RAP_METRICS_MAPPING_ID = 25
)
WHERE EXISTS (
    SELECT 1
    FROM RAP_METRICS_DETAILS d
    JOIN RAP_METRICS_PACK_MAPPING p
      ON d.RAP_METRICS_MAPPING_ID = p.RAP_METRICS_MAPPING_ID
    WHERE d.MASTER_METRIC_ID = m.MASTER_METRIC_ID
      AND d.RAP_METRICS_MAPPING_ID = 25
      AND m.MASTER_METRIC_NAME <> p.METRICS_DISP
);
