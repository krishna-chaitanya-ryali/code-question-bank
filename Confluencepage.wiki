# Sample data you already fetched from AD or somewhere
records = [
    {
        "employee_id": "123456",
        "line_manager_id": "LM001",
        "line_manager_name": "John Doe",
        "line_manager_mail": "john.doe@hsbc.com"
    },
    {
        "employee_id": "123457",
        "line_manager_id": "LM002",
        "line_manager_name": "Jane Smith",
        "line_manager_mail": "jane.smith@hsbc.com"
    }
]

output_file = "update_user_tab.sql"

with open(output_file, "w", encoding="utf-8") as f:
    for r in records:
        emp_id = r["employee_id"]
        mgr_id = r["line_manager_id"].replace("'", "''") if r["line_manager_id"] else ""
        mgr_name = r["line_manager_name"].replace("'", "''") if r["line_manager_name"] else ""
        mgr_mail = r["line_manager_mail"].replace("'", "''") if r["line_manager_mail"] else ""

        sql = (
            f"UPDATE user_tab SET "
            f"line_manager_id = '{mgr_id}', "
            f"line_manager_name = '{mgr_name}', "
            f"line_manager_mail = '{mgr_mail}' "
            f"WHERE employee_id = '{emp_id}';\n"
        )

        f.write(sql)
