SELECT m.MASTER_METRIC_NAME, r.RISK_HEADER, COUNT(*) AS cnt
FROM RAP_MASTER_METRIC_DETAILS m
JOIN RAP_RISK_TYPE r ON m.RISK_TYPE_ID = r.RISK_TYPE_ID
GROUP BY m.MASTER_METRIC_NAME, r.RISK_HEADER
HAVING COUNT(*) > 1
ORDER BY m.MASTER_METRIC_NAME, r.RISK_HEADER;

SELECT m.*, r.*
FROM RAP_MASTER_METRIC_DETAILS m
JOIN RAP_RISK_TYPE r ON m.RISK_TYPE_ID = r.RISK_TYPE_ID
WHERE (m.MASTER_METRIC_NAME, r.RISK_HEADER) IN (
    SELECT m.MASTER_METRIC_NAME, r.RISK_HEADER
    FROM RAP_MASTER_METRIC_DETAILS m
    JOIN RAP_RISK_TYPE r ON m.RISK_TYPE_ID = r.RISK_TYPE_ID
    GROUP BY m.MASTER_METRIC_NAME, r.RISK_HEADER
    HAVING COUNT(*) > 1
)
ORDER BY m.MASTER_METRIC_NAME, r.RISK_HEADER;
